package com.bosch.inst.base.security.keycloak.service;

import Credentials;
import com.fasterxml.jackson.core.JsonProcessingException;
import java.net.URISyntaxException;
import java.util.List;
import java.util.Map;
import javax.servlet.http.HttpServletRequest;
import org.keycloak.adapters.KeycloakDeployment;
import org.keycloak.adapters.spi.HttpFacade;
import org.keycloak.admin.client.Keycloak;
import org.keycloak.representations.AccessTokenResponse;
import org.keycloak.representations.idm.GroupRepresentation;
import org.keycloak.representations.idm.RealmRepresentation;
import org.keycloak.representations.idm.RoleRepresentation;
import org.keycloak.representations.idm.UserRepresentation;

public interface IKeycloakService {


  Keycloak getKeycloakInstance();


  AccessTokenResponse getAccessToken(Credentials credentials);

  AccessTokenResponse refreshAccessToken()
      throws URISyntaxException, JsonProcessingException;

  List<RealmRepresentation> getRealms();

  UserRepresentation getLoginUser();

  UserRepresentation selfRegistration(UserRepresentation user);

  void sendVerifyEmail(String userId);

  void resetPasswordEmail(String username);

  void setRealmLevelRoles(String userId, List<String> realmRoles);

  void setClientLevelRoles(String userId, Map<String, List<String>> clientRoles);

  void setGroups(String userId, List<String> groupIds);

  UserRepresentation getUserById(String userId);

  List<UserRepresentation> getUserByUsername(String username);

  List<UserRepresentation> getUsers();

  List<UserRepresentation> searchForUserByAttribute(String attributeName,
      String attributeValue);

  List<UserRepresentation> searchForUserByUsernameFirstLastNameEmail(String search,
      Integer firstResult, Integer maxResults);

  GroupRepresentation getGroupById(String groupId);

  List<GroupRepresentation> getGroupsByUserId(String userId);

  List<GroupRepresentation> getGroups();

  List<UserRepresentation> getGroupUserMembers(String groupId);

  List<RoleRepresentation> getRealmLevelRolesByUserId(String userId);

  Map<String, List<RoleRepresentation>> getClientLevelRolesByUserId(String userId);

  List<RoleRepresentation> getAllRolesByUserId(String userId);

  List<String> getRoleNamesByLoginUser();

  RoleRepresentation getRoleByName(String roleName);

  List<RoleRepresentation> getRoles();

  List<UserRepresentation> getRoleUserMembers(String roleName);

  List<GroupRepresentation> getRoleGroupMembers(String roleName);

  KeycloakDeployment getRealmInfo(String tenant);

  String getTenant(HttpFacade.Request facade);

  String getTenant(HttpServletRequest httpServletRequest);

  String getCookie(HttpServletRequest httpServletRequest, String key);
}
